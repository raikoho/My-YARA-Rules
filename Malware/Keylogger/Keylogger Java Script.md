```
rule JavaScriptKeylogger
{
    meta:
        description = "Detects a JavaScript keylogger"
        author = "Bohdan Misonh"
        last_modified = "2025-01-29"
        severity = "high"

    strings:
        $keylogger = /document\.addEventListener\s*\(['"]keydown['"]\s*,\s*function/i
        $input_capture = /document\.onkeydown\s*=\s*function/i
        $file_writer = /Blob\s*\(\s*data\s*,\s*\{type\s*:\s*['"]text\/plain['"]\}/i

    condition:
        $keylogger or $input_capture or $file_writer
}
```
