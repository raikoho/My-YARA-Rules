```
rule CSharpKeylogger
{
    meta:
        description = "Detects a C# keylogger"
        author = "Bohdan Misonh"
        last_modified = "2025-01-29"
        severity = "high"

    strings:
        $keyhook = /using\s+System\.Windows\.Forms\s*;\s*Keyboard\.Hook/i
        $keylogger_class = /public\s+class\s+Keylogger/i
        $key_listener = /Keyboard\.HookKeyPress/i
        $file_writer = /File\.AppendAllText\s*\(["'][^"']*\.txt["']\)/i
        $input_capture = /SendKeys\.Send/i

    condition:
        $keyhook or $keylogger_class or $key_listener or $file_writer or $input_capture
}
```

`$keyhook`: Searches for usage of the System.Windows.Forms library and keywords related to keyboard event handling, such as Keyboard.Hook.
`$keylogger_class`: Searches for the Keylogger class declaration, which is typical for most C# keyloggers.
`$key_listener`: Searches for usage of the Keyboard.HookKeyPress function to capture keystrokes.
`$file_writer`: Searches for writing to a file, particularly text files (.txt), where keystrokes are often stored.
`$input_capture`: Searches for usage of SendKeys.Send to automatically input text, which can be used in keyloggers to simulate keystrokes.
