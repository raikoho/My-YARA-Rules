```
rule PythonKeylogger
{
    meta:
        description = "Detects a Python keylogger"
        author = "Your Name"
        last_modified = "2025-01-29"
        severity = "high"

    strings:
        $keylogger = /import\s+keyboard|pyautogui|pynput|os\.system\s*\(['"][^'"]*'["']\)/i
        $keyboard_listener = /keyboard\.hook|keyboard\.record/i
        $file_writer = /open\s*\(['"][^'"]*\.txt["']\)\s*,\s*['"]w['"]\)/i

    condition:
        $keylogger or $keyboard_listener or $file_writer
}
```

---------------

`$keylogger`: Searches for imports of libraries that are commonly used in keyloggers (e.g. keyboard, pyautogui, pynput).
`$keyboard_listener`: Searches for calls to functions that can be used to capture keystrokes (e.g. keyboard.hook or keyboard.record).
`$file_writer`: Searches for calls to functions to open files for writing, which are commonly used in keyloggers to save input.
This rule searches for parent types that may be present in keylogger code written in Python.
