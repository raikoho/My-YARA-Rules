```
rule JavaKeylogger
{
    meta:
        description = "Detects a Java keylogger"
        author = "Bohdan Misonh"
        last_modified = "2025-01-29"
        severity = "high"

    strings:
        $keyhook = /import\s+java\.awt\.event\.KeyListener/i
        $keylogger_class = /public\s+class\s+Keylogger/i
        $key_listener = /addKeyListener\s*\(.*\)/i
        $file_writer = /File\.write\s*\(["'][^"']*\.txt["']\)/i
        $input_capture = /Robot\s+\.\s+keyPress/i

    condition:
        $keyhook or $keylogger_class or $key_listener or $file_writer or $input_capture
}
```
