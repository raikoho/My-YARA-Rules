```
rule GoKeylogger
{
    meta:
        description = "Detects a Go keylogger in C++"
        author = "Bohdan Misonh"
        last_modified = "2025-01-29"
        severity = "high"

    strings:
        $go_package = /#include\s+["<]golang\.org\/x\/text\/keypad[">]/i
        $keyhook = /keyhook\.InstallHook/i
        $file_writer = /fopen\s*\(["'][^"']*\.txt["']\)/i
        $keyboard_input = /key\.Input/i

    condition:
        $go_package or $keyhook or $file_writer or $keyboard_input
```

---------------

`$go_package`: Searches for Go library bindings that are used for keyboard operations, including golang.org/x/text/keypad.
`$keyhook`: Searches for function calls to install a keyboard hook (e.g. keyhook.InstallHook).
`$file_writer`: Searches for a file opener for writing (e.g. fopen), which can be used to store keystrokes.
`$keyboard_input`: Searches for a function that handles keyboard input (e.g. key.Input).
