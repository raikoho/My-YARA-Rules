```
rule UniversalKeylogger
{
    meta:
        description = "Detects a keylogger regardless of programming language"
        author = "Bohdan Misonh"
        last_modified = "2025-01-29"
        severity = "high"

    strings:
        $keyhook = /hook.*\s*keyboard|input/i
        $key_listener = /add.*listener|capture.*key/i
        $key_press = /key\s*(press|down|up)/i
        $file_writer = /write\s*.*\s*file.*\.(txt|log|csv)/i
        $event_listener = /document\.addEventListener\s*\(['"]keydown['"]\)/i
        $send_key = /SendKeys\.Send/i
        $capture_input = /getInput|readLine|scan/i

    condition:
        $keyhook or $key_listener or $key_press or $file_writer or $event_listener or $send_key or $capture_input
}
```

`$keyhook`: Searches for hook patterns that can be used to capture keystrokes or input.
`$key_listener`: Searches for patterns that involve adding listeners for keyboard events.
`$key_press`: Searches for calls or changes that ignore keystrokes.
`$file_writer`: Searches for attempts to write to a file, which is typical of keyloggers.
`$event_listener`: Searches for event listeners for keystrokes (especially JavaScript).
`$send_key`: Searches for SendKeys.Send calls that are used to simulate keystrokes.
`$capture_input`: Searches for functions that capture user input.
